{
    "$schema": "https://raw.githubusercontent.com/F5Networks/f5-appsvcs-extension/master/schema/latest/as3-schema.json",
    "class": "AS3",
    "declaration": {
        "class": "ADC",
        "schemaVersion": "3.37.0",
        "id": "urn:uuid:25de5645-a12c-4c62-9bda-50a7ff99db13",
        "label": "Converted Declaration",
        "remark": "Generated by Automation Config Converter",
        "Common": {
            "class": "Tenant",
            "Shared": {
                "class": "Application",
                "template": "shared",
                "asm_auto_l7_policy__vs_test": {
                    "rules": [
                        {
                            "name": "default",
                            "actions": [
                                {
                                    "event": "request",
                                    "type": "waf",
                                    "enabled": true
                                }
                            ]
                        }
                    ],
                    "strategy": "first-match",
                    "class": "Endpoint_Policy"
                },
                "pool_test": {
                    "members": [
                        {
                            "addressDiscovery": "static",
                            "servicePort": 443,
                            "serverAddresses": [
                                "172.31.5.7"
                            ],
                            "shareNodes": true
                        }
                    ],
                    "monitors": [
                        {
                            "bigip": "/Common/http_head_f5"
                        }
                    ],
                    "class": "Pool"
                },
                "vs_test": {
                    "layer4": "tcp",
                    "persistenceMethods": [
                        "cookie"
                    ],
                    "pool": "pool_test",
                    "securityLogProfiles": [
                        {
                            "use": "/Common/Shared/mylogging"
                        }
                    ],
                    "translateServerAddress": true,
                    "translateServerPort": true,
                    "class": "Service_HTTPS",
                    "serverTLS": {
                        "bigip": "/Common/clientssl"
                    },
                    "profileDOS": {
                        "bigip": "/Common/dos"
                    },
                    "profileHTTP": {
                        "bigip": "/Common/http"
                    },
                    "clientTLS": {
                        "bigip": "/Common/serverssl"
                    },
                    "profileTCP": {
                        "bigip": "/Common/tcp"
                    },
                    "redirect80": false,
                    "virtualAddresses": [
                        "172.31.5.15"
                    ],
                    "virtualPort": 443,
                    "snat": "auto",
                    "policyEndpoint": "/Common/Shared/asm_auto_l7_policy__vs_test"
                },
                "myhttps_head": {
                    "adaptive": false,
                    "interval": 5,
                    "dscp": 0,
                    "receive": "Server\\:",
                    "send": "HEAD / HTTP/1.0\\r\\nHost:itsigp2.it-solutions.com.mx\\r\\n\\r\\n",
                    "timeUntilUp": 0,
                    "timeout": 16,
                    "class": "Monitor",
                    "monitorType": "https",
                    "targetAddress": "",
                    "targetPort": 0,
                    "upInterval": 0,
                    "transparent": false,
                    "reverse": false
                },
                "myhttp": {
                    "xForwardedFor": true,
                    "proxyType": "reverse",
                    "class": "HTTP_Profile"
                },
                "myddos-profile": {
                    "application": {
                        "botDefense": {
                            "issueCaptchaChallenge": false
                        },
                        "captchaResponse": {
                            "failure": "You have entered an invalid answer for the question. Please, try again.\n<br>\n%DOSL7.captcha.image% %DOSL7.captcha.audio% %DOSL7.captcha.change%\n<br>\n<b>What code is in the image\\?</b>\n%DOSL7.captcha.solution%\n<br>\n%DOSL7.captcha.submit%\n<br>\n<br>\nYour support ID is: %DOSL7.captcha.support_id%.",
                            "first": "This question is for testing whether you are a human visitor and to prevent automated spam submission.\n<br>\n%DOSL7.captcha.image% %DOSL7.captcha.audio% %DOSL7.captcha.change%\n<br>\n<b>What code is in the image\\?</b>\n%DOSL7.captcha.solution%\n<br>\n%DOSL7.captcha.submit%\n<br>\n<br>\nYour support ID is: %DOSL7.captcha.support_id%."
                        },
                        "heavyURLProtection": {
                            "automaticDetectionEnabled": false
                        },
                        "rateBasedDetection": {
                            "operationMode": "off",
                            "thresholdsMode": "manual",
                            "sourceIP": {
                                "rateLimitingEnabled": false
                            },
                            "url": {
                                "heavyURLProtectionEnabled": false,
                                "rateLimitingEnabled": false
                            }
                        },
                        "stressBasedDetection": {
                            "thresholdsMode": "manual",
                            "operationMode": "transparent",
                            "badActor": {
                                "mitigationMode": "none"
                            },
                            "url": {
                                "heavyURLProtectionEnabled": false,
                                "rateLimitingEnabled": false
                            }
                        }
                    },
                    "class": "DOS_Profile"
                },
                "my-CEF-log": {
                    "application": {
                        "localStorage": false,
                        "protocol": "udp",
                        "remoteStorage": "arcsight",
                        "servers": [
                            {
                                "address": "172.31.5.133",
                                "port": "514"
                            }
                        ],
                        "storageFilter": {
                            "requestType": "illegal"
                        }
                    },
                    "class": "Security_Log_Profile"
                },
                "mylog-rsyslog": {
                    "application": {
                        "maxEntryLength": "10k",
                        "localStorage": false,
                        "protocol": "udp",
                        "remoteStorage": "remote",
                        "servers": [
                            {
                                "address": "172.31.5.35",
                                "port": "514"
                            },
                            {
                                "address": "172.31.5.133",
                                "port": "514"
                            }
                        ],
                        "storageFilter": {
                            "requestType": "illegal"
                        },
                        "storageFormat": {
                            "fields": [
                                "vs_name",
                                "policy_name",
                                "attack_type",
                                "ip_client",
                                "x_forwarded_for_header_value",
                                "geo_location",
                                "dest_ip",
                                "dest_port",
                                "request",
                                "method",
                                "uri",
                                "request_status",
                                "response_code",
                                "sig_cves",
                                "sig_names",
                                "sub_violations",
                                "violations",
                                "violation_rating",
                                "support_id"
                            ]
                        }
                    },
                    "class": "Security_Log_Profile"
                },
                "mylogging": {
                    "application": {
                        "storageFilter": {
                            "requestType": "all"
                        }
                    },
                    "botDefense": {
                        "logAlarm": true,
                        "logBlock": true,
                        "logBrowser": true,
                        "logBrowserVerificationAction": true,
                        "logCaptcha": true,
                        "logChallengeFailureRequest": true,
                        "logDeviceIdCollectionRequest": true,
                        "logHoneyPotPage": true,
                        "logMaliciousBot": true,
                        "logMobileApplication": true,
                        "logRateLimit": true,
                        "logRedirectToPool": true,
                        "logSuspiciousBrowser": true,
                        "logTcpReset": true,
                        "logTrustedBot": true,
                        "logUnknown": true,
                        "logUntrustedBot": true,
                        "localPublisher": {
                            "bigip": "/Common/local-db-publisher"
                        }
                    },
                    "dosApplication": {
                        "localPublisher": {
                            "bigip": "/Common/local-db-publisher"
                        }
                    },
                    "class": "Security_Log_Profile"
                }
            }
        }
    }
}